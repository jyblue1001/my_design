**Scripts for $g_m/I_D$ Lookup-Table Generation (closed-source tools: Matlab, HSpice, Spectre)**

Our book comes with Matlab scripts for the design examples of each chapter, lookup tables for a 65 nm process technology, and a lookup function (updated version also contained in this directory) for data read-in and interpolation. The scripts provided in this folder are for those who want to generate their own lookup tables. Please refer to Appendix 2 of our book for a more detailed description of the lookup table generation flow (summarized in the figure below).


<img src="flow.png" width="500" />

**What You Need**

* A model file for the CMOS technology that you want to characterize. For example, a set of PSP, BSIM3, BSIM4 or BSIM6 model cards.
* A circuit simulator: Spectre (Cadence) or HSpice (Synopsys).
* A function for reading simulation data in into Matlab (pick one of these two options)
    * For Spectre: cds_srr. This function is part of the Cadence Spectre/RF MATLAB Toolbox, see “Virtuoso Spectre Circuit Simulator RF Theory Manual.” You must ensure that your Matlab versions and MMSIM versions are compatible.
    * For HSpice: loadsig. This function is included in Michael Perrott’s HSpice Toolbox for Matlab and Octave, http://www.cppsim.com/download_hspice_tools.html.
* It is assumed that you launch the provided code within a Matlab instance running in the same Unix/Linux environment as your simulator (to enable direct file exchange).
* It is assumed that you have some experience with setting up EDA tools. The provided scripts are far from “plug and play.” You need to look at each line in the header of the configuration file and determine appropriate adjustments for your system.

**File Descriptions**

*techsweep_spectre_run.m, techsweep_hspice_run.m*: These are the top-level scripts that execute the lookup table generation. You should not have to edit these files, except for specifying the proper configuration file near the top.

*techsweep_config_psp_65_spectre.m, techsweep_config_bsim4_28_spectre.m, techsweep_config_bsim4_45_hspice.m, techsweep_config_bsimcmg_16_spectre.m, techsweep_config_bsim3_180_hspice.m*: These are example configuration files that are called by the top-level scripts. The “psp_65” file is what we used to generate the data files distributed with the book (65nch.mat and 65pch.mat). The other files are provided as examples for your convenience and can be edited to work with your own BSIM3, BSIM4 or BSIM-CMG models. The configuration files define all tool and file paths and contain a netlist template near the bottom. This is where you define the content of the auto-generated simulation netlist (see above figure). Also, the configuration file defines how the raw simulation parameters are mapped into Matlab variables (for example: CGG = cgs + cgd + cdb). It typically takes some time to get all the paths and settings right (especially for cds_srr). In my experience, things are more easily debugged when using HSpice & loadsig.

*techsweep_spectre_debug.m, techsweep_hspice_debug.m*: Utility scripts designed for debugging the configuration files. Basically, these are simplified versions of techsweep_*_run.m files and run just one single simulation sweep and display the parameters at mid-supply. Once this works, the full table generation can be kicked off and should work without any problems. 

*look_up.m, look_upVGS.m*: Functions that can read and interpolate the created lookup tables (mat files). See description in Jespers & Murmann (or type “help look_up” in Matlab).

*test_lookup.m*: Lookup usage examples.

*ee214b_hspice.sp*: BSIM3 models for a typical 180-nm CMOS process.

*180nch.mat, 180pch.mat*: Lookup tables for the 180nm CMOS process. These files were generated by running techsweep_hspice_run.m with the model file ee214b_hspice.sp (as defined in techsweep_config_bsim3_180_hspice.m).
