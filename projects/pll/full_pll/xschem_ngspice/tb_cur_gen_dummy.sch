v {xschem version=3.4.6 file_version=1.2}
G {}
K {}
V {}
S {}
E {}
B 2 3570 -2040 4560 -1170 {flags=graph
y1=-0.00048
y2=0.76
ypos1=0
ypos2=2
divy=5
subdivy=1
unity=1
x1=0
x2=5e-06
divx=5
subdivx=1
xlabmag=1.0
ylabmag=1.0
node=v1
color=7
dataset=0
unitx=1
logx=0
logy=0
}
B 2 4760 -2040 5750 -1170 {flags=graph
y1=0
y2=0.00011
ypos1=0
ypos2=2
divy=5
subdivy=1
unity=1
x1=0
x2=5e-06
divx=5
subdivx=1
xlabmag=1.0
ylabmag=1.0
node=i(@m.xm50.msky130_fd_pr__pfet_01v8[id])
color=6
dataset=0
unitx=1
logx=0
logy=0
}
N 2730 -2620 2730 -2420 {lab=GND}
N 2730 -3470 2730 -3310 {
lab=VDD}
N 2730 -3280 2770 -3280 {lab=VDD}
N 2770 -3350 2770 -3280 {lab=VDD}
N 2730 -3350 2770 -3350 {lab=VDD}
N 2730 -3160 2830 -3160 {lab=V1}
N 2730 -3250 2730 -2680 {lab=V1}
N 3480 -3140 3520 -3140 {lab=VDD}
N 3520 -3210 3520 -3140 {lab=VDD}
N 3480 -3210 3520 -3210 {lab=VDD}
N 3290 -3140 3440 -3140 {lab=V2}
N 3110 -3120 3160 -3120 {lab=V_CUR_REF_REG}
N 3110 -3120 3110 -2860 {lab=V_CUR_REF_REG}
N 3110 -2860 3480 -2860 {lab=V_CUR_REF_REG}
N 3480 -3110 3480 -2680 {lab=V_CUR_REF_REG}
N 2830 -3160 3160 -3160 {lab=V1}
N 2730 -3470 3480 -3470 {lab=VDD}
N 3480 -3470 3480 -3170 {lab=VDD}
N 2730 -2420 3480 -2420 {lab=GND}
N 3480 -2620 3480 -2420 {lab=GND}
N 3380 -3140 3380 -3040 {lab=V2}
N 3380 -3040 4440 -3040 {lab=V2}
N 2460 -3350 2460 -3280 {lab=V_TOP}
N 2460 -3470 2460 -3410 {lab=VDD}
N 2320 -3470 2730 -3470 {lab=VDD}
N 1530 -2420 1910 -2420 {
lab=GND}
N 1490 -2500 1490 -2420 {
lab=GND}
N 1870 -2500 1870 -2420 {
lab=GND}
N 1490 -2420 1530 -2420 {
lab=GND}
N 1570 -3360 1710 -3360 {
lab=V_TOP}
N 1710 -3360 1870 -3360 {
lab=V_TOP}
N 1530 -3470 1530 -3390 {
lab=VDD}
N 1530 -3470 1910 -3470 {
lab=VDD}
N 1910 -3470 1910 -3390 {
lab=VDD}
N 1910 -2620 1910 -2530 {lab=Vbe2}
N 2170 -2620 2170 -2420 {lab=GND}
N 1290 -2620 1290 -2420 {lab=GND}
N 1910 -3360 1950 -3360 {lab=VDD}
N 1950 -3430 1950 -3360 {lab=VDD}
N 1910 -3430 1950 -3430 {lab=VDD}
N 1490 -3360 1530 -3360 {lab=VDD}
N 1490 -3430 1490 -3360 {lab=VDD}
N 1490 -3430 1530 -3430 {lab=VDD}
N 1290 -2420 1490 -2420 {lab=GND}
N 1910 -2470 1910 -2420 {lab=GND}
N 1530 -2470 1530 -2420 {lab=GND}
N 770 -3360 770 -3280 {lab=V_TOP}
N 520 -3220 520 -3090 {lab=START_UP}
N 520 -3470 520 -3390 {
lab=VDD}
N 480 -3360 520 -3360 {lab=VDD}
N 480 -3430 480 -3360 {lab=VDD}
N 480 -3430 520 -3430 {lab=VDD}
N 520 -3330 520 -3220 {lab=START_UP}
N 520 -3470 1530 -3470 {lab=VDD}
N 770 -3360 1330 -3360 {lab=V_TOP}
N 1330 -3360 1330 -3310 {lab=V_TOP}
N 1330 -3310 1650 -3310 {lab=V_TOP}
N 520 -3250 730 -3250 {lab=START_UP}
N 520 -2420 1290 -2420 {lab=GND}
N 1650 -3360 1650 -3310 {lab=V_TOP}
N 770 -3050 1530 -3050 {lab=bgr_Vin-}
N 480 -3060 480 -2990 {lab=GND}
N 480 -3060 520 -3060 {lab=GND}
N 520 -2500 520 -2420 {lab=GND}
N 770 -3250 810 -3250 {lab=VDD}
N 520 -2680 520 -2500 {lab=GND}
N 560 -3360 770 -3360 {lab=V_TOP}
N 520 -3120 580 -3120 {lab=START_UP}
N 580 -3120 580 -3060 {lab=START_UP}
N 560 -3060 580 -3060 {lab=START_UP}
N 770 -3220 770 -3050 {lab=bgr_Vin-}
N 1290 -2830 1290 -2680 {lab=bgr_Vin-}
N 2170 -2830 2170 -2680 {lab=bgr_Vin+}
N 1720 -2420 1720 -2350 {lab=GND}
N 1230 -2650 1270 -2650 {lab=GND}
N 1850 -2650 1890 -2650 {lab=GND}
N 2190 -2650 2230 -2650 {lab=GND}
N 1630 -3020 1650 -3020 {lab=GND}
N 1770 -3020 1790 -3020 {lab=VDD}
N 810 -3470 810 -3250 {lab=VDD}
N 1730 -2960 1730 -2830 {lab=bgr_Vin+}
N 1690 -2960 1690 -2830 {lab=bgr_Vin-}
N 1730 -2830 2170 -2830 {lab=bgr_Vin+}
N 1290 -2830 1690 -2830 {lab=bgr_Vin-}
N 1710 -3360 1710 -3090 {lab=V_TOP}
N 1910 -2830 1910 -2680 {lab=bgr_Vin+}
N 1910 -3330 1910 -2830 {lab=bgr_Vin+}
N 1530 -2830 1530 -2530 {lab=bgr_Vin-}
N 1530 -3330 1530 -2830 {lab=bgr_Vin-}
N 480 -2640 520 -2640 {lab=GND}
N 480 -2710 480 -2640 {lab=GND}
N 480 -2710 520 -2710 {lab=GND}
N 520 -2770 580 -2770 {lab=START_UP_NFET1}
N 580 -2770 580 -2710 {lab=START_UP_NFET1}
N 560 -2710 580 -2710 {lab=START_UP_NFET1}
N 520 -3030 520 -2740 {lab=START_UP_NFET1}
N 1910 -2420 2170 -2420 {lab=GND}
N 2170 -2420 2730 -2420 {lab=GND}
N 1910 -3470 2320 -3470 {lab=VDD}
N 1810 -3280 2690 -3280 {lab=V_TOP}
N 1810 -3360 1810 -3280 {lab=V_TOP}
N 2750 -2650 2790 -2650 {lab=GND}
N 3420 -2650 3460 -2650 {lab=GND}
N 1720 -3540 1720 -3470 {lab=VDD}
N 3640 -3140 3680 -3140 {lab=VDD}
N 3640 -3210 3640 -3140 {lab=VDD}
N 3640 -3210 3680 -3210 {lab=VDD}
N 3680 -3470 3680 -3170 {lab=VDD}
N 3680 -3210 3760 -3210 {lab=VDD}
N 3760 -3210 3760 -3140 {lab=VDD}
N 3720 -3140 3760 -3140 {lab=VDD}
N 3680 -3110 3680 -3080 {lab=V_CUR_REF_REG}
N 3480 -3080 3680 -3080 {lab=V_CUR_REF_REG}
N 480 -2990 480 -2710 {lab=GND}
N 2960 -3470 2960 -3310 {
lab=VDD}
N 2960 -3280 3000 -3280 {lab=VDD}
N 3000 -3350 3000 -3280 {lab=VDD}
N 2960 -3350 3000 -3350 {lab=VDD}
N 2870 -3280 2920 -3280 {lab=VDD}
N 2870 -3350 2870 -3280 {lab=VDD}
N 2870 -3350 2960 -3350 {lab=VDD}
N 2730 -3210 2960 -3210 {lab=V1}
N 2960 -3250 2960 -3210 {lab=V1}
N 980 -3220 980 -3150 {lab=V_TOP}
N 810 -3250 980 -3250 {lab=VDD}
N 980 -3470 980 -3280 {lab=VDD}
N 1020 -3250 1060 -3250 {lab=VDD}
N 1060 -3330 1060 -3250 {lab=VDD}
N 980 -3330 1060 -3330 {lab=VDD}
N 770 -3310 870 -3310 {lab=V_TOP}
N 870 -3310 870 -3150 {lab=V_TOP}
N 870 -3150 980 -3150 {lab=V_TOP}
N 3480 -3470 3680 -3470 {lab=VDD}
N 4050 -3140 4090 -3140 {lab=VDD}
N 4090 -3210 4090 -3140 {lab=VDD}
N 4050 -3210 4090 -3210 {lab=VDD}
N 4050 -3470 4050 -3170 {lab=VDD}
N 4210 -3140 4250 -3140 {lab=VDD}
N 4210 -3210 4210 -3140 {lab=VDD}
N 4210 -3210 4250 -3210 {lab=VDD}
N 4250 -3470 4250 -3170 {lab=VDD}
N 4250 -3210 4330 -3210 {lab=VDD}
N 4330 -3210 4330 -3140 {lab=VDD}
N 4290 -3140 4330 -3140 {lab=VDD}
N 4250 -3110 4250 -3080 {lab=CURRENT_OUTPUT}
N 4050 -3080 4250 -3080 {lab=CURRENT_OUTPUT}
N 4050 -3470 4250 -3470 {lab=VDD}
N 3680 -3470 4050 -3470 {lab=VDD}
N 4010 -3140 4010 -3040 {lab=V2}
N 4050 -3110 4050 -2850 {lab=CURRENT_OUTPUT}
C {devices/vsource.sym} 2050 -1720 0 0 {name=V1 value="pwl(0 0 1us 0 2us 1.8)" savecurrent=false
* 1.8}
C {devices/gnd.sym} 2050 -1690 0 0 {name=l3 lab=GND}
C {devices/vdd.sym} 2050 -1750 0 0 {name=l4 lab=VDD}
C {sky130_fd_pr/corner.sym} 1860 -1770 0 0 {name=CORNER only_toplevel=false corner=tt}
C {simulator_commands_shown.sym} 2370 -2060 0 0 {name=COMMANDS
simulator=ngspice
only_toplevel=false 
value="
* ngspice commands


.option method=gear
.option wnflag=1
* .option savecurrents
* .temp =140

.save
+@m.xm50.msky130_fd_pr__pfet_01v8[id]
+@m.xm1.msky130_fd_pr__pfet_01v8[gm]
+@m.xm1.msky130_fd_pr__pfet_01v8[vth]
+@m.xm1.msky130_fd_pr__pfet_01v8[vgs]
+@m.xm1.msky130_fd_pr__pfet_01v8[vds]
+@m.x1.xm1.msky130_fd_pr__nfet_01v8[gm]

* .ic v(vin-) = 0.8
* .ic v(vin+) = 0.8
* .ic v(v_top) = 1.8

.control

    save all
    * dc temp -40 120 5 V1 1.6 2.0 0.05
    * dc V1 1.7 1.9 0.001 temp -40 120 40
    * dc V1 0.0 2.0 0.02 temp -40 120 20
    * dc V1 0 2.0 0.02
    tran 0.4ns 5us
    remzerovec
    write tb_cur_gen_dummy.raw
.endc

"}
C {sky130_fd_pr/pfet_01v8.sym} 2710 -3280 0 0 {name=M45
W=12
L=0.5
nf=4
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/res_xhigh_po_0p35.sym} 2730 -2650 0 1 {name=R4
L=10
model=res_xhigh_po_0p35
spiceprefix=X
mult=1}
C {sky130_fd_pr/res_xhigh_po_0p35.sym} 3480 -2650 0 0 {name=R5
L=1
model=res_xhigh_po_0p35
spiceprefix=X
mult=1}
C {sky130_fd_pr/pfet_01v8.sym} 3460 -3140 0 0 {name=M50
W=10
L=0.15
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {lab_wire.sym} 3480 -2860 0 1 {name=p41 sig_type=std_logic lab=V_CUR_REF_REG}
C {lab_wire.sym} 2560 -3280 2 0 {name=p56 sig_type=std_logic lab=V_TOP}
C {sky130_fd_pr/cap_mim_m3_1.sym} 2460 -3380 2 0 {name=C1 model=cap_mim_m3_1 W=2 L=2 MF=20 spiceprefix=X}
C {devices/lab_pin.sym} 1910 -2570 2 0 {name=p67 sig_type=std_logic lab=Vbe2}
C {sky130_fd_pr/pnp_05v5.sym} 1510 -2500 0 0 {name=Q1
model=pnp_05v5_W3p40L3p40
m=1
spiceprefix=X
}
C {sky130_fd_pr/pnp_05v5.sym} 1890 -2500 0 0 {name=Q2
model=pnp_05v5_W3p40L3p40
m=8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 1550 -3360 0 1 {name=M51
W=12
L=0.5
nf=4
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 1890 -3360 0 0 {name=M53
W=12
L=0.5
nf=4
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {lab_wire.sym} 1810 -2830 2 0 {name=p70 sig_type=std_logic lab=bgr_Vin+}
C {lab_wire.sym} 1620 -2830 2 1 {name=p71 sig_type=std_logic lab=bgr_Vin-}
C {sky130_fd_pr/res_xhigh_po_0p35.sym} 1910 -2650 0 0 {name=R3
L=2.3
model=res_xhigh_po_0p35
spiceprefix=X
mult=1}
C {sky130_fd_pr/res_xhigh_po_0p35.sym} 2170 -2650 0 1 {name=R6
L=18
model=res_xhigh_po_0p35
spiceprefix=X
mult=1}
C {sky130_fd_pr/res_xhigh_po_0p35.sym} 1290 -2650 0 0 {name=R7
L=18
model=res_xhigh_po_0p35
spiceprefix=X
mult=1}
C {sky130_fd_pr/nfet_01v8.sym} 540 -3060 0 1 {name=M54
W=1
L=10
nf=1 
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 540 -3360 0 1 {name=M55
W=12
L=0.5
nf=4
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {devices/lab_pin.sym} 520 -3250 2 1 {name=p72 sig_type=std_logic lab=START_UP}
C {lab_wire.sym} 770 -3360 0 0 {name=p73 sig_type=std_logic lab=V_TOP}
C {sky130_fd_pr/pfet_01v8.sym} 750 -3250 0 0 {name=M56
W=2
L=0.15
nf=2
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8.sym} 540 -2710 0 1 {name=M57
W=1
L=10
nf=1 
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {devices/lab_pin.sym} 520 -2950 2 0 {name=p90 sig_type=std_logic lab=START_UP_NFET1}
C {/foss/designs/my_design/projects/bandgapref/xschem_ngspice/new_files/opamp_bandgap_2.sym} 1710 -3020 1 1 {name=x1}
C {/foss/designs/my_design/projects/bandgapref/xschem_ngspice/new_files/opamp_bandgap_2.sym} 3220 -3140 2 1 {name=x2}
C {lab_wire.sym} 4440 -3040 2 0 {name=p95 sig_type=std_logic lab=V2}
C {sky130_fd_pr/pfet_01v8.sym} 3700 -3140 0 1 {name=M80
W=10
L=0.15
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 2940 -3280 0 0 {name=M83
W=6
L=0.5
nf=2
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 1000 -3250 0 1 {name=M92
W=2
L=0.15
nf=2
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {devices/gnd.sym} 1630 -3020 0 1 {name=l1 lab=GND}
C {devices/vdd.sym} 1790 -3020 0 0 {name=l2 lab=VDD}
C {devices/gnd.sym} 1230 -2650 0 1 {name=l5 lab=GND}
C {devices/gnd.sym} 1720 -2350 0 1 {name=l6 lab=GND}
C {devices/gnd.sym} 1850 -2650 0 1 {name=l7 lab=GND}
C {devices/gnd.sym} 2230 -2650 0 0 {name=l8 lab=GND}
C {devices/gnd.sym} 2790 -2650 0 0 {name=l9 lab=GND}
C {devices/vdd.sym} 1720 -3540 0 0 {name=l10 lab=VDD}
C {devices/gnd.sym} 3420 -2650 0 1 {name=l11 lab=GND}
C {devices/gnd.sym} 3220 -3200 2 1 {name=l12 lab=GND}
C {devices/vdd.sym} 3220 -3080 2 0 {name=l13 lab=VDD}
C {lab_wire.sym} 2730 -3040 0 0 {name=p1 sig_type=std_logic lab=V1}
C {sky130_fd_pr/pfet_01v8.sym} 4030 -3140 0 0 {name=M1
W=10
L=0.15
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 4270 -3140 0 1 {name=M2
W=10
L=0.15
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {lab_wire.sym} 4050 -2850 2 0 {name=p3 sig_type=std_logic lab=CURRENT_OUTPUT}
